!function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var i=n(1),a=(o(i),n(13)),s=o(a),l=n(14),r=o(l),u=n(25),c=void 0,d=n(9),f=d.shell,h=(d.ipcRenderer,n(26)),p=function(t){var e=h.parse(t).protocol;return("http:"===e||"https:"===e)&&(f.openExternal(t),!0)};$(document).ready(function(){document.title=document.title+" ("+u.Config.version+(u.Config.beta?" Beta":"")+")";var t=document.querySelectorAll('link[rel="import"]'),e=$("#contents");$(t).each(function(t,n){var o=n.import.querySelector(".tab-template"),i=document.importNode(o.content,!0);e.append(i)}),$("webview").each(function(t,e){e.addEventListener("did-finish-load",function(e){console.log(t,e)}),e.addEventListener("will-navigate",function(t){p(t.url)&&e.stop()})}),s.default.select_tab("cocos"),$("button").on("click",function(t){t.target.blur()}),c=new r.default,$("#tabbar").hide(),$("#contents").css("top","77px")}),$(document).on("click",'a[href^="http"]',function(t){p(t.target.href)&&t.preventDefault()})},function(t,n,o){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=o(2),l=o(3),r=o(5),u=o(12),c=void 0,d={adcolony:"AD UNITS",admob:"AD UNITS",agecheq:"MORE",amazon:"APP STORES",appnext:"AD UNITS",appodeal:"AD UNITS",apteligent:"ANALYTICS",bee7:"AD UNITS",chartboost:"AD UNITS",facebook:"SOCIAL",flurryanalytics:"ANALYTICS",fyber:"AD UNITS",googleanalytics:"ANALYTICS",gpg:"ESSENTIALS",iap:"ESSENTIALS",inmobi:"AD UNITS",kochava:"ATTRIBUTION",leadbolt:"AD UNITS",onesignal:"PUSH NOTIFICATION",playphone:"APP STORES",review:"ESSENTIALS",sdkboxads:"ESSENTIALS",sdkboxplay:"ESSENTIALS",share:"ESSENTIALS",scientificrevenue:"IAP OPTIMIZATION",tune:"ATTRIBUTION",valuepotion:"IAP OPTIMIZATION",vungle:"AD UNITS",youtube:"MORE"},f={adcolony:"Instant-play™ HD the best user experience, hands down.",agecheq:"Easy compliance with the US and Euro Child Privacy Laws",appodeal:"Maximize your app revenue efficiently with programmatic ad mediation for publishers.",bee7:"Our Native rewarded re-engagement system encourages valuable players to stay in your game.",chartboost:"The largest mobile games-only platform to increase revenue and discover new players.",facebook:"The world's largest social media network.",flurryanalytics:"Adopt the industry standard, for free.",googleanalytics:"Turn insights into action.",iap:"Implement Cross-Platform IAP easily. Support Apple AppStore, Google Play, Amazon AppStore, and Playphone store.",inmobi:"The Discovery Platform for a Mobile-First World.",kochava:"Driving Effective Mobile Ad Spend",leadbolt:"The high-performance mobile advertising platform for user acquisition and app monetization.",review:"More downloads of your app with App store ratings and reviews.",tune:"Making mobile marketing better, for everyone.",valuepotion:"Monetize your full user base and get your values up!",vungle:"Infrastructure for app monetization through video ads.",youtube:"Single API to play YouTube videos on both iOS and Android.",fyber:"Designed with you in mind, Fyber empowers developers to execute smart ad monetization strategies.",playphone:"Your new, must-have game monetization channel in the world’s fastest growing gaming markets.",scientificrevenue:"Pricing without Compromise.",admob:"Monetize your apps intelligently",amazon:"The exclusive appstore on Kindle tablets, but available for other devices, too.",appnext:"Grow Your Mobile Business by Promoting Apps.",sdkboxplay:"Cross platform support for both Apple Game Center and Google Play Services, including Login, Achievement and Leaderboard.",gpg:"The most secure and reliable game services for your mobile games now available on both Android and iOS!",onesignal:"OneSignal is a free high volume Push Notification service.",apteligent:"Build Better Apps Faster: crash reporting and realtime performance data.",sdkboxads:"An easy-to-use package that includes all SDKBOX supported Ad Units.",share:"Grow audience network by publishing social messages to Facebook and Twitter."};t.exports=function(){function t(){i(this,t),this.manifestJson=null,this.serverUrl="http://download.sdkbox.com/installer/v1/",this.sdkbox_path=r.getSdkboxBinPath(),this.projects={},this.observerTagPrefix="ObserverTag-",this.observerTagCounter=1}return a(t,null,[{key:"getInstance",value:function(){return c||(c=new t),c}}]),a(t,[{key:"getDownloadPath",value:function(t,e){if(null==this.manifestJson)return null;t=t.toLowerCase();try{var n=this.manifestJson.packages[t].versions,o=null;for(var i in n){o=n[i][e],o=$.extend({},o);break}return null==o?null:(o.bundle=this.serverUrl+o.bundle,o)}catch(t){return null}}},{key:"getDisplayName",value:function(t){if(null==this.manifestJson)return null;var e=t;try{e=this.manifestJson.packages[t].display_name}catch(n){e=t}return e}},{key:"getPluginName",value:function(t){if(null==this.manifestJson)return null;var e=Object.keys(this.manifestJson.packages);for(var n in e){var o=e[n],i=this.manifestJson.packages[o].display_name;if(i==t)return o}}},{key:"getInstallerPath",value:function(){if(null==this.manifestJson)return null;try{var t=this.manifestJson.packages.SDKBOX.versions,e=null;for(var n in t){e=t[n],e=$.extend({},e);break}return null==e?null:(e.bundle=this.serverUrl+e.bundle,e)}catch(t){return null}}},{key:"fetchManifest",value:function(t){var e=this;this.fetchJson(this.serverUrl+"manifest.json",function(n,o){e.addCategoryInfo(n),e.addDescptionInfo(n),t(n,o)})}},{key:"fetchPackage",value:function(t,e,n){var o=this;this.fetchManifest(function(i,a){if(null==i)return void n(null,"fetch manifest failed");var s=o.getDownloadPath(t,e);o.fetchData(s,n)})}},{key:"fetchJson",value:function(t,e){if(null!=this.manifestJson)return void e(this.manifestJson,null);var n=this;this.fetchUrl(t,function(t){"string"==typeof t?e(null,t):t instanceof Response?t.ok?t.json().then(function(t){n.manifestJson=t,e(n.manifestJson,null)}):e(null,"failed, status: "+t.status):e(null,"unknow res type")})}},{key:"fetchData",value:function(t,e){return null==t?void e(null,"failed, url is null"):void this.fetchUrl(t,function(t){"string"==typeof t?e(null,t):t instanceof Response?t.ok?e(t,null):e(null,"failed, status: "+t.status):e(null,"unknow res type")})}},{key:"fetchUrl",value:function(t,e){fetch(t).then(function(t){e(t)},function(t){e(t.message)})}},{key:"getInstalledPlugins",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!n&&t in this.projects&&this.projects[t]?void(e&&e(this.projects[t],null)):void this.queryInstalledPlugins(t,e)}},{key:"queryInstalledPlugins",value:function(t,n){var o=this;if(!u.isFile(s.join(t,".sdkbox_packages.json")))return console.log("project not include sdkbox packages"),this.projects[t]=this.projects[t]||{},void n(this.projects[t]);var i="sdkbox info "+t,a=l.getInstance();if(!a.query(i)){var r=[this.sdkbox_path,"--alwaysupdate","--local","--jsonapi","info"],c={tag:i,cwd:t};a.exec(r,c,function(i,a,s){var l=null,r=null;try{i?r=e.toString():(null!=a&&0!=a.length||(a="{}"),l=JSON.parse(a))}catch(t){r=t.toString()}r||(o.projects[t]=l),n&&n(l,r);for(var u in o._installedPluginsObserver)o._installedPluginsObserver[u]&&o._installedPluginsObserver[u](l,t)})}}},{key:"observeInstalledPlugin",value:function(t){this._installedPluginsObserver||(this._installedPluginsObserver={}),this._installedPluginsObserver[""+this.observerTagPrefix+this.observerTagCounter]=t,this.observerTagCounter++}},{key:"getDependency",value:function(t){if(Array.isArray(t)){var e=[];for(var n in t){var o=t[n],i=this.getDependency(o);i&&(e=e.concat(i))}return e}if(this.manifestJson){var a=t,s=null;try{s=this.manifestJson.packages[a].dependence}catch(t){console.log(t),s=null}return s&&0==s.length&&(s=null),s}}},{key:"addCategoryInfo",value:function(t){if(t)for(var e in t.packages){var n=t.packages[e];if(!n.category){var o=d[e]?d[e]:"MORE";n.category=o}}}},{key:"addDescptionInfo",value:function(t){if(t)for(var e in t.packages){var n=t.packages[e];if(!n.description){var o=f[e]?f[e]:"SDKBox Plugin:"+e;n.description=o}}}}]),t}()},function(t,e){t.exports=require("path")},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=n(4),l=void 0;t.exports=function(){function t(){o(this,t),this._process=new Map}return a(t,null,[{key:"getInstance",value:function(){return l||(l=new t),l}}]),a(t,[{key:"exec",value:function(t,e,n){this._nextId++;var o=t.shift(),a=e.tag;delete e.tag;var l=s.spawn(o,t,e);console.log("[CLI] spawn ("+l.pid+"): "+o+" "+t.join(" "));var r=this._process;r.set(a,l);var u=[],c=[];l.stdout.on("data",function(t){u.push(t),"object"===("undefined"==typeof n?"undefined":i(n))&&n.stdout(t)}),l.stderr.on("data",function(t){c.push(t),"object"===("undefined"==typeof n?"undefined":i(n))&&n.stderr(t)}),l.on("error",function(t){r.has(a)&&r.delete(a),"object"===("undefined"==typeof n?"undefined":i(n))?n.error(t,u.join(""),c.join("")):"function"==typeof n&&n(t,u.join(""),c.join(""))}),l.on("exit",function(t,e){e=e?e:"",console.log("[CLI] exit ("+l.pid+") "+t+" "+e),r.has(a)&&r.delete(a),"object"===("undefined"==typeof n?"undefined":i(n))?n.exit(u.join(""),c.join("")):"function"==typeof n&&n(null,u.join(""),c.join(""))})}},{key:"kill",value:function(t){if(this._process.has(t)){var e=this._process[t];e&&e.kill(),this._process.delete(t)}}},{key:"query",value:function(t){return this._process.has(t)}}]),t}()},function(t,e){t.exports=require("child_process")},function(t,e,n){"use strict";function o(t){var e=r.join(l.homedir(),".sdkbox","bin","sdkbox"),n=null;try{n=u.statSync(e)}catch(t){n=null}return!!n&&n.isFile()}function i(){o()||s()}function a(){var t=r.join(l.homedir(),".sdkbox","bin","sdkbox");return t?"win32"==l.platform()?t+".bat":t:void c.showErrorBox("SDKBox installer not found","can't found installer at ~/.sdkbox/bin")}function s(){var t=d.getInstance(),e="install sdkbox";if(!t.query(e)){var n=f.getInstance();n.open(),n.disableClose(),n.clear(),n.log("Prepare to install SDKBox Installer, please wait...");var o=["python","-c","import urllib; s = urllib.urlopen('https://raw.githubusercontent.com/sdkbox-doc/en/master/install/install.py').read(); exec s"];t.exec(o,{tag:e},{stdout:function(t){n.log(t.toString())},stderr:function(t){n.log(t.toString())},exit:function(t,e){n.enableClose()},error:function(t,e,o){n.log(t.toString());var i="\n\nInstall SDKBox installer failed.\nPlease tell us at (http://www.sdkbox.com/answers/)";n.log(i)}})}}var l=n(6),r=n(2),u=n(7),c=(n(8),n(9).remote.dialog),d=n(3),f=n(10);e.installIf=i,e.getSdkboxBinPath=a,e.isInstalled=o},function(t,e){t.exports=require("os")},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("process")},function(t,e){t.exports=require("electron")},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();n(11);var a=void 0;t.exports=function(){function t(){var e=this;o(this,t),this._enableClose=!1,this._dialog=getConsoleOutputDialog(),this._dialog.on("dialogbeforeclose",function(t,n){return e._enableClose}),this._output=this._dialog.find(".output"),this._buttonsHtml=this._dialog.parent().find(".ui-dialog-buttonset button"),this.disableClose()}return i(t,null,[{key:"getInstance",value:function(){return a||(a=new t),a}}]),i(t,[{key:"open",value:function(){this._dialog.dialog("open"),this._dialog.dialog("moveToTop")}},{key:"close",value:function(){this._dialog.dialog("close")}},{key:"enableClose",value:function(){this._enableClose=!0,this._buttonsHtml.button("enable")}},{key:"disableClose",value:function(){this._enableClose=!1,this._buttonsHtml.button("disable")}},{key:"log",value:function(t){var e=$("<div>").html(t.autoLink());this._output.append(e),this._output.append("\n")}},{key:"clear",value:function(){this._output.empty()}}]),t}()},function(t,e){"use strict";(function(){var t=[].slice;String.prototype.autoLink=function(){var e,n,o,i,a,s;return i=1<=arguments.length?t.call(arguments,0):[],a=/(^|[\s\n]|<[A-Za-z]*\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,0<i.length?(o=i[0],n=function(){var t;t=[];for(e in o)s=o[e],"callback"!==e&&t.push(" "+e+"='"+s+"'");return t}().join(""),this.replace(a,function(t,e,i){return t=("function"==typeof o.callback?o.callback(i):void 0)||"<a href='"+i+"'"+n+">"+i+"</a>",""+e+t})):this.replace(a,"$1<a href='$2'>$2</a>")}}).call(void 0)},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=n(7),l=o(s);t.exports=function(){function t(){i(this,t)}return a(t,null,[{key:"arrayUnique",value:function(t){for(var e=0;e<t.length;++e)for(var n=e+1;n<t.length;++n)t[e]===t[n]&&t.splice(n--,1);return t}},{key:"queryParams",value:function(){for(var t={},e=window.location.search.substring(1),n=e.split("&"),o=0;o<n.length;o++){var i=n[o].split("=");if("undefined"==typeof t[i[0]])t[i[0]]=decodeURIComponent(i[1]);else if("string"==typeof t[i[0]]){var a=[t[i[0]],decodeURIComponent(i[1])];t[i[0]]=a}else t[i[0]].push(decodeURIComponent(i[1]))}return t}},{key:"isFile",value:function(t){var e=null;try{e=l.default.statSync(t)}catch(t){e=null}return!!e&&e.isFile()}},{key:"isDir",value:function(t){var e=null;try{e=l.default.statSync(t)}catch(t){e=null}return!!e&&e.isDirectory()}}]),t}()},function(t,e){"use strict";function n(t){o.find("div.tab-contents").addClass("hidden"),o.find("div#tab-"+t).removeClass("hidden"),o.find("div#tab-"+t).focus(),i.removeClass("selected"),$("#tabbar li[tag="+t+"]").addClass("selected")}var o=$("#contents"),i=$("#tabbar li");i.each(function(t,e){$(e).on("click",function(t){var e=$(t.target);e.hasClass("selected")||n(e.attr("tag"))})}),e.select_tab=n},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(9),s=n(9).ipcRenderer,l=n(9).remote,r=l.BrowserWindow,u=l.dialog,c=n(2),d=n(5),f=n(3),h=n(15),p=(n(17),n(19)),g=n(20),v=(n(10),n(21),n(22)),m=n(1),b=n(23),_=n(12),y=n(12).queryParams(),w=5;t.exports=function(){function t(){var e=this;o(this,t),this.sdkbox_path=d.getSdkboxBinPath(),this._configs={};this._addCurProjectIf(),this._listHtml=$("#tab-cocos .projects-list ul"),this._projectHtmlTpl=this._listHtml.find("li.template");var n=$("#tab-cocos .projects-details");this._detailsPlaceholderHtml=n.find(".placeholder"),this._detailsPlaceholderHtml.show(),this._detailsWrapperHtml=n.find(".details"),this._detailsWrapperHtml.hide(),this._detailsHtml={},this._detailsHtml.name={icon:n.find(".name .icon img"),title:n.find(".name h2")};var i=n.find(".basics");this._detailsHtml.basics={location:i.find(".location span"),engine:i.find(".engine span"),buildHint:n.find(".build-hint")},this._detailsHtml.live={blocks:n.find(".live"),tbody:n.find(".live.block tbody")},this._detailsHtml.plugins={tbody:n.find(".plugins.block tbody")},$("button.import").on("click",function(){e._onImportClick()}),$(".forStandalone").hide(),n.find("button.build-project").on("click",function(){e._onBuildProjectClick()}),this._buttons={import:n.find("button.import-plugin"),update:n.find("button.update-all-plugins"),open:n.find("button.open-project-folder"),build:n.find("button.build-project")},n.find("button.open-project-folder").on("click",function(){e._onOpenProjectFolderClick()}),n.find("button.remove-project").on("click",function(){e._onRemoveProjectClick()}),n.find("button.import-plugin").on("click",function(){e._onImportPluginClick()}),n.find("button.update-all-plugins").on("click",function(){e._onUpdateAllPluginsClick()}),this._projects=new h(p),this._loaders=new Map,this._importPluginsDialog=new g,this._importPluginsDialog.load(),m.getInstance().observeInstalledPlugin(function(t,n){e.observerInstalledPlugin(t,n)}),Array.isArray(this._configs.cocosProjects)&&this._configs.cocosProjects.forEach(function(t){e._addProject(t,!0)}),s.on("SDKBox:build-finish",function(){e._configs.cocosProjects=[],e._addCurProjectIf(),e._listHtml.empty(),e._projects.clear(),Array.isArray(e._configs.cocosProjects)&&e._configs.cocosProjects.forEach(function(t){e._addProject(t,!0)}),e._detailsPlaceholderHtml.show(),e._detailsWrapperHtml.hide(),e._showFirstProjectDetail()}),d.installIf(),this._showFirstProjectDetail()}return i(t,[{key:"_showBuildHint",value:function(t){t?this._detailsHtml.basics.buildHint.show():this._detailsHtml.basics.buildHint.hide()}},{key:"_addCurProjectIf",value:function(){var t=this._findProjects(y.project);for(var e in t)this._addProjectIf(t[e]);if(null==this._configs.cocosProjects||0==this._configs.cocosProjects.length){var n=c.basename(y.project);this._addProjectIf({projectName:n,projectPath:y.project})}}},{key:"_addProjectIf",value:function(t){this._configs.cocosProjects=this._configs.cocosProjects||[];var e=this._configs.cocosProjects.indexOf(t);0!=e&&(e>0&&this._configs.cocosProjects.removeAt(e),this._configs.cocosProjects.unshift(t))}},{key:"_findProjects",value:function(t){var e=c.basename(t),n=[],o=c.join(t,"build","jsb-default");return _.isDir(o)&&n.push({projectName:e,projectPath:o}),o=c.join(t,"build","jsb-link"),_.isDir(o)&&n.push({projectName:e,projectPath:o}),o=c.join(t,"build","jsb-binary"),_.isDir(o)&&n.push({projectName:e,projectPath:o}),n}},{key:"_onImportClick",value:function(){var t=this;s.send("open-file-dialog"),s.once("selected-directory",function(e,n){if(n)try{n=n[0],t._addProject(n)}catch(t){u.showErrorBox("Import Project Failed",t.toString())}})}},{key:"_onBuildProjectClick",value:function(){s.send("builder:open")}},{key:"_onOpenProjectFolderClick",value:function(){var t=this._detailsHtml.basics.location.text(),e=this._projects.get(t);a.shell.showItemInFolder(e.path),a.shell.beep()}},{key:"_onRemoveProjectClick",value:function(){var t=this,e={type:"question",buttons:["No","Yes"],defaultId:0,title:"Are you sure remove selected project ?",message:"Are you sure remove selected project ?",detail:"Project folder and files will not be deleted.",cancelId:0};u.showMessageBox(e,function(e){if(1==e){var n;!function(){var e=t._detailsHtml.basics.location.text(),o=f.getInstance();o.kill("sdkbox info "+e),o.kill("sdkbox list "+e),o.kill("sdkbox import "+e),t._listHtml.find("> li").each(function(t,n){$(n).attr("path")===e&&$(n).remove()}),t._projects.remove(e),t._detailsPlaceholderHtml.show(),t._detailsWrapperHtml.hide(),n=t._configs.cocosProjects.indexOf(e),n>-1?(t._configs.cocosProjects.splice(n,1),b.getInstance().save(t._configs)):console.log("remove project, can't find "+e)}()}})}},{key:"_onImportPluginClick",value:function(){var t=this,e=this._detailsHtml.basics.location.text(),n=this._projects.get(e);this._importPluginsDialog.open(n,function(){t._queryProjectSdkboxInfo(n,!0)})}},{key:"_onUpdateAllPluginsClick",value:function(){var t=this,e=this._detailsHtml.basics.location.text(),n=this._projects.get(e),o={type:"question",buttons:["Update","Cancel"],defaultId:0,title:"Confirm update all installed plugins",message:"Confirm update all installed plugins:",detail:n.path,cancelId:1};u.showMessageBox(r.getFocusedWindow(),o,function(e){0===e&&t._updateAllPlugins(n)})}},{key:"_showLoader",value:function(t){if(this._loaders.has(t.path))return!1;var e=this._queryItem(t);return e&&e.find(".loader").show(),this._loaders.set(t.path,!0),!0}},{key:"_hideLoader",value:function(t){if(!this._loaders.has(t.path))return!1;var e=this._queryItem(t);return e&&e.find(".loader").hide(),this._loaders.delete(t.path),!0}},{key:"_showFirstProjectDetail",value:function(){var t=this._projects.first();this._showProjectDetail(t,this._queryItem(t))}},{key:"_showProjectDetail",value:function(t,e){t&&e&&(this._listHtml.find("> li").removeClass("selected"),e.addClass("selected"),this._updateDetails(t,!0),this._detailsPlaceholderHtml.hide(),this._detailsWrapperHtml.show(),this._queryProjectSdkboxInfo(t))}},{key:"_addProject",value:function(t,e){var n=this,o=null;try{o=this._projects.add(t)}catch(t){return}var i=this._projectHtmlTpl.clone();if(i.attr("path",o.path),i.find(".loader").hide(),i.removeClass("template"),i.on("click",function(){n._showProjectDetail(o,i)}),this._listHtml.append(i),this._updateItem(o),this._queryProjectSdkboxInfo(o),!e){Array.isArray(this._configs.cocosProjects)||(this._configs.cocosProjects=[]);var a=this._configs.cocosProjects;a.push(t);for(var s=a.length,l=new Map,r=s-1;r>=0;r--)l.has(a[r])?a.splice(r,1):l.set(a[r],!0);b.getInstance().save(this._configs)}}},{key:"_queryItem",value:function(t){for(var e=this._listHtml.find("> li"),n=0;n<e.length;n++){var o=$(e[n]);if(o.attr("path")==t.path)return o}return null}},{key:"_updateItem",value:function(t){var e=this._queryItem(t);if(e){var n=e.find(".icon img");n.attr("src","../assets/img/cocos-project-icon.png"),e.find(".name h2").text(t.name),t.live&&e.find(".tags").append("<span>Live</span>");var o=e.find(".plugins-tags");o.empty(),$.each(t.plugins,function(t,e){o.append("<span>"+e.name+"</span>")})}}},{key:"_updateDetails",value:function(t,e){var n=this._detailsHtml;if(e||n.basics.location.text()===t.path){n.name.icon.attr("src","../assets/img/cocos-project-icon.png"),n.name.title.text(t.name),n.basics.location.text(t.path),n.basics.engine.text(t.engine),null==t.template?(n.basics.buildHint.show(),this._buttons.import.attr("disabled",!0).addClass("ui-state-disabled"),this._buttons.update.attr("disabled",!0).addClass("ui-state-disabled")):(n.basics.buildHint.hide(),this._buttons.import.attr("disabled",!1).removeClass("ui-state-disabled"),this._buttons.update.attr("disabled",!1).removeClass("ui-state-disabled")),t.live?n.live.blocks.show():n.live.blocks.hide();var o=n.plugins.tbody;o.empty(),Array.isArray(t.plugins)&&$(t.plugins).each(function(t,e){var n=m.getInstance().getDisplayName(e.name.toString());n=n?n:e.name.toString();var i="</td><td>-</td></tr>";"googleplayservices"!=e.name.toString()&&(i='</td><td><a href="http://docs.sdkbox.com/en/plugins/'+e.name.toString()+'">Doc</a></td></tr>'),o.append("<tr><td>"+n+"</td><td>"+e.version.toString()+i)})}}},{key:"_queryProjectSdkboxInfo",value:function(t,e){var n=this;this._showLoader(t),m.getInstance().getInstalledPlugins(t.path,function(e,o){o?u.showErrorBox("Query SDKBOX Info Failed",o):t.updatePluginsFromJSON(e),n._hideLoader(t),n._updateItem(t),n._updateDetails(t),t._lastQuery=Date.now()})}},{key:"observerInstalledPlugin",value:function(t,e){if(this._projects){var n=this._projects.get(e);if(n&&!(Date.now()-n._lastQuery<1e3*w)&&t){var o=this._detailsHtml.basics.location.text();o===e&&(this._queryProjectSdkboxInfo(n),n._lastQuery=Date.now())}}}},{key:"_updateAllPlugins",value:function(t){var e=[];Array.isArray(t.plugins)&&$(t.plugins).each(function(t,n){e.push(n.name.toString())});var n=new v({plugins:e,project:t.path,cmd:"update",installedPlugins:e});n.show()}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(16);t.exports=function(){function t(e){o(this,t),this._items=new Map,this._projectClass=e}return i(t,[{key:"add",value:function(t){var e=new this._projectClass(t);if(!e.validate())throw new Error('This is path "'+t+'" is not project');if(this._items.has(e.path))throw new Error('This path "'+t+'" already imported');return this._items.set(e.path,e),e}},{key:"remove",value:function(t){a(this._items.has(t)),this._items.delete(t)}},{key:"get",value:function(t){return a(this._items.has(t)),this._items.get(t)}},{key:"first",value:function(){return this._items.values().next().value}},{key:"clear",value:function(){this._items.clear()}},{key:"count",value:function(){return this._items.size}}]),t}()},function(t,e){t.exports=require("assert")},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=n(6),r="win32"===l.platform()?"\\":"/",u=n(7),c=(n(4),n(18));t.exports=function(t){function e(t){o(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"cocos"));return n._live=!1,n._plugins=[],n}return a(e,t),s(e,[{key:"validate",value:function(){var t=this._path+r+".cocos-project.json";try{var e=JSON.parse(u.readFileSync(t));this._engine=e.engine_version}catch(t){return console.log("CocosProject.validate() failed: "+t.toString()),!1}return!0}},{key:"updatePluginsFromJSON",value:function(t){var e=[];for(var n in t){var o=t[n],i={name:o.name,version:o.version.join(".")};e.push(i)}this._plugins=e.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})}},{key:"live",get:function(){return this._live}},{key:"plugins",get:function(){return this._plugins}}]),e}(c)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(6),s="win32"===a.platform()?"\\":"/";t.exports=function(){function t(e,n){o(this,t);var i=null;if("string"==typeof e){e=e.toString();var a=e.charAt(e.length-1);"/"!==a&&"\\"!==a||(e=e.substring(0,e.length-2)),i=e.substring(e.lastIndexOf(s)+1)}else i=e.projectName,e=e.projectPath;this._name=i,this._path=e,this._engine=n,this._icon=""}return i(t,[{key:"validate",value:function(){return!1}},{key:"name",get:function(){return this._name}},{key:"path",get:function(){return this._path}},{key:"engine",get:function(){return this._engine}},{key:"icon",get:function(){return this._icon}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=n(6),r="win32"===l.platform()?"\\":"/",u=n(7),c=n(2),d=(n(4),n(12)),f=n(18);t.exports=function(t){function e(t){o(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"creator"));return n._live=!1,n._plugins=[],n._template=null,n}return a(e,t),s(e,[{key:"validate",value:function(){var t=this._path+r+".cocos-project.json";d.isFile(t)?(this._template=c.basename(this._path),console.log("creator template:",this._template)):t=this._path+r+"project.json";try{var e=JSON.parse(u.readFileSync(t));this._engine=e.engine}catch(t){return console.log("CreatorProject.validate() failed: "+t.toString()),!1}return!0}},{key:"updatePluginsFromJSON",value:function(t){var e=[];for(var n in t){var o=t[n],i={name:o.name,version:o.version.join(".")};e.push(i)}this._plugins=e.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})}},{key:"live",get:function(){return this._live}},{key:"plugins",get:function(){return this._plugins}},{key:"template",get:function(){return this._template}}]),e}(f)},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(9).remote.dialog,s=n(9).remote.BrowserWindow,l=n(5),r=(n(3),n(10)),u=(n(21),n(22)),c=n(1),d=["ESSENTIALS","ANALYTICS","IAP OPTIMIZATION","APP STORES","AD UNITS","SOCIAL","ATTRIBUTION","PUSH NOTIFICATION","MORE"],f=function(){function t(){o(this,t),this.plugins={},this._lastLoad=0,this.sdkbox_path=l.getSdkboxBinPath()}return i(t,[{key:"load",value:function(t){var e=this;this._callback=t,c.getInstance().fetchManifest(function(t,n){e._onLoadCallback(n,t,null)})}},{key:"_onLoadCallback",value:function(t,e,n){var o=this;try{if(t)throw new Error(t.toString());!function(){var t=e.packages,n=[];Object.keys(t).forEach(function(e){if("SDKBOX"!=e){var o=t[e];if(!o.is_library){var i={name:e,display_name:o.display_name,category:o.category,description:o.description};Object.keys(o.versions).forEach(function(t){i.version=t}),n.push(i)}}}),o.plugins={},n.forEach(function(t){var e=o.plugins[t.category];e||(e=[]),e.push(t),o.plugins[t.category]=e}),o._lastLoad=Date.now(),"function"==typeof o._callback&&(o._callback(!0),o._callback=null)}()}catch(t){a.showErrorBox("Download Plugins List Failed",t.toString()),"function"==typeof this._callback&&(this._callback(!1),this._callback=null)}}}]),t}();t.exports=function(){function t(){var e=this;o(this,t),this._dialog=getImportCocosPluginsDialog(),this._dialog.on("dialogclose",function(){e._onClose()}),this._consoleDialog=r.getInstance(),this._loaderHtml=this._dialog.find(".loader"),this._contentsHtml=this._dialog.find(".contents"),this._treeHtml=this._contentsHtml.find("> div"),this._treeComponentTpl=this._treeHtml.find(".tree-component"),
this._list=new f,this.sdkbox_path=this._list.sdkbox_path}return i(t,[{key:"load",value:function(){l.isInstalled()&&this._list.load()}},{key:"open",value:function(t,e){var n=this;this._project=t,this._callback=e,this._loaderHtml.show(),this._contentsHtml.hide(),this._treeHtml.empty(),this._dialog.dialog("open"),this._list.load(function(e){e?n._updateTable(t):n._dialog.dialog("close")})}},{key:"_onClose",value:function(){this._project=null,this._callback=null}},{key:"_updateTable",value:function(t){this._loaderHtml.hide(),this._contentsHtml.show();var e=new Map;t.plugins.forEach(function(t){e.set(t.name,t)});var n=this._list.plugins,o=!0,i=!1,a=void 0;try{for(var s,l=d[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var r=s.value;this._treeHtml.append(this.genTreeComponent(r,n[r]))}}catch(t){i=!0,a=t}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}this.registerEvent()}},{key:"genTreeComponent",value:function(t,e){var n=this._treeComponentTpl.clone();n.removeClass("hidden"),n.find(".tree-header-content").html(t);var o="tree-item-bg-",i=1;return e.forEach(function(t){var e='\n            <div class="tree-item '+(o+i)+'">\n                <span class="tree-item-content">\n                    '+t.display_name+'\n                    <span class="tree-item-content-tip">'+t.description+'</span>\n                </span>\n                <button class="tree-item-action">Import</button>\n            </div>\n            ';n.find(".tree-content").append($(e)),i+=1,i=i>2?1:i}),n}},{key:"registerEvent",value:function(){var t=this;this._treeHtml.find(".tree-header").on("click",function(){var t=$(this),e=t.parent(),n=e.find(".tree-content"),o=n.is(":visible")?"-90":"0";n.toggle(100),e.find(".tree-header-icon").css({transform:"rotate("+o+"deg)"})}),this._treeHtml.find(".tree-item-action").on("click",function(){var e=$(this),n=e.parent(),o=n.find(".tree-item-content").get(0).firstChild.nodeValue.trim();t._onImportClick(c.getInstance().getPluginName(o),o)})}},{key:"_onImportClick",value:function(t,e){var n=this,o=[];if(o.push(t),0===o.length)return void a.showErrorBox("Warning","Please select least one plugin");var i={type:"question",buttons:["Import","Cancel"],defaultId:0,title:"Confirm import selected plugins",message:"Confirm import selected plugins:",detail:e,cancelId:1};a.showMessageBox(s.getFocusedWindow(),i,function(t){if(0===t){var e=n._callback,i=n._project;n._dialog.dialog("close"),n._callback=e,n._project=i,n._selected=o,n._importPlugin()}})}},{key:"_importFinish",value:function(){this._consoleDialog.enableClose();var t=this._callback;this._project=null,this._callback=null,t()}},{key:"_importPlugin",value:function(){var t=this;c.getInstance().getInstalledPlugins(this._project.path,function(e,n){if(n)a.showErrorBox("Query SDKBOX Info Failed",n);else{var o=new u({plugins:t._selected,project:t._project.path,cmd:"import",installedPlugins:Object.keys(e)});o.show()}})}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(9),s=a.ipcRenderer,l=void 0;t.exports=function(){function t(){var e=this;o(this,t),s.on("download-status",function(t,n){"interrupted"===n.state?(e._downloadFailList.push(e._downloadingPlugin),e.download()):"progressing"===n.state&&e.setProgress(n.downloadRatio)}),s.on("download-finish",function(t,n){delete e._dlUrl,"completed"===n.state?e._downloadSuccessList.push(e._downloadingPlugin):(e._downloadFailList.push(e._downloadingPlugin),console.log("download failed:"+n.state)),e.download()}),this._dialog=getDownloadDialog(),this._dialog.on("dialogbeforeclose",function(t,n){return e._dlUrl&&s.send("cancel-download-file",e._dlUrl),!0}),this._download_bar=this._dialog.parent().find(".download-progress .download-bar"),this._download_label=this._dialog.parent().find(".download-progress .download-bar .download-label")}return i(t,null,[{key:"getInstance",value:function(){return l||(l=new t),l}}]),i(t,[{key:"startDownload",value:function(t,e,n){var o=this;this._dlUrl=url,this._downloadList=t,this._downloadSuccessList=[],this._downloadFailList=[],this._pluginVersion=e,this._downloadingPlugin=null,this._callback=n,dataMgr.getInstance().fetchManifest(function(t,e){null!=t?(o.download(),o.show()):o._callback(null,e)})}},{key:"download",value:function(){return this._downloadingPlugin=this._downloadList.shift(),this._downloadingPlugin?(this._dlUrl=dataMgr.getInstance().getDownloadPath(this._downloadingPlugin,this._pluginVersion),void(this._dlUrl?s.send("download-file",this._dlUrl):(this._downloadFailList.push(this._downloadingPlugin),this.download()))):void(0==this._downloadFailList.size()?this._callback(this._downloadSuccessList,null):this._callback(this._downloadSuccessList,"not all plugin download success"))}},{key:"setProgress",value:function(t){this._download_bar.css("width",Math.floor(t)+"%"),this._download_label.html(t+"%")}},{key:"show",value:function(){this._dialog.dialog("open"),this._dialog.dialog("moveToTop")}},{key:"hiden",value:function(){this._dialog.dialog("close")}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(12),s=n(6),l=n(2),r=n(7),u=n(9),c=u.ipcRenderer;n(9).remote.dialog;n(11);var d=n(3),f=n(1),h=n(5),p=void 0;t.exports=function(){function t(e){var n=this;o(this,t),this.options=e,"installer"in this.options&&(this.options.installer=!1),this.sdkbox_path=h.getSdkboxBinPath(),this._enableClose=!1,this._dialog||(this._dialog=getInstallSdkboxPluginsDialog(),this._dialog.on("dialogbeforeclose",function(t,e){return n._enableClose}),this._downloads=this._dialog.find(".download-plugin-list"),this._downloadItemTemplate=this._downloads.find(".download-plugin-item.hidden"),this._documents=this._dialog.find(".plugin-document-list"),this._documentItemTemplate=this._documents.find(".plugin-document-item.hidden"),this._cliOutput=this._dialog.find(".import-cli-output"),this._buttonCancel=this._dialog.parent().find(".ui-dialog-buttonset button"),this._downloadItemTemplate.detach(),this._documentItemTemplate.detach(),this.registerDownloadEvent()),this.clear(),f.getInstance().fetchManifest(function(t,e){e||(n.resetDownloadItems(n.options.plugins,n.options.installer),n.resetDialog(),n.enableClose(),n._buttonCancel.addClass("ui-state-active"),n.tryInstall(),n.downloadNext())})}return i(t,null,[{key:"getInstance",value:function(){return p||(p=new t),p}}]),i(t,[{key:"show",value:function(){this._dialog.dialog("open"),this._dialog.dialog("moveToTop")}},{key:"close",value:function(){this._dialog.dialog("close")}},{key:"enableClose",value:function(){this._enableClose=!0,this._buttonCancel.button("enable")}},{key:"disableClose",value:function(){this._enableClose=!1,this._buttonCancel.button("disable")}},{key:"clear",value:function(){this._buttonCancel.text("Cancel"),this._downloads.empty(),this._downloads.append(this._downloadItemTemplate),this._documents.empty(),this._documents.append(this._documentItemTemplate),this._cliOutput.empty()}},{key:"appendDependency",value:function(t){var e=f.getInstance().getDependency(t);return e=e.concat(t),e=a.arrayUnique(e)}},{key:"resetDownloadItems",value:function(t,e){var n=this.appendDependency(t),o=[];e&&o.push({name:"Installer",bundle:f.getInstance().getInstallerPath(),status:"pending"});for(var i in n){var a=n[i],s=f.getInstance().getDownloadPath(a,"v3");null!=s&&o.push({name:a,display_name:f.getInstance().getDisplayName(a),bundle:s,status:this.checkPluginValid(s)})}this._installItems=o}},{key:"checkPluginValid",value:function(t){var e=t.bundle.split("/").pop(),n=l.join(s.homedir(),".sdkbox","plugins",e);if(r.existsSync(n))return"ready";n=n.slice(0,-7);var o=null;try{o=r.statSync(n)}catch(t){o=null}return o&&o.isDirectory()?"ready":"pending"}},{key:"resetDialog",value:function(){for(var t in this._installItems){var e=this._installItems[t],n=this._downloadItemTemplate.clone();if(n.removeClass("hidden"),n.find(".download-plugin-name").html(e.display_name),n.find(".download-plugin-status").html(e.status),"ready"==e.status&&(n.find(".download-plugin-bar").css("width","100%"),n.find(".download-plugin-label").html("100%")),this._downloads.append(n),"installer"!==e.name.toLowerCase()&&"googleplayservices"!==e.name){var o=this._documentItemTemplate.clone();o.removeClass("hidden"),o.find(".plugin-document-item-name").html(e.display_name);var i=e.name.toLowerCase();o.find(".plugin-document-item-docs").attr("href","http://docs.sdkbox.com/en/plugins/"+i),o.find(".plugin-document-item-sample").attr("href","https://github.com/sdkbox/sdkbox-sample-"+i),this._documents.append(o)}}}},{key:"changeItemStatus",value:function(t,e,n){for(var o=this._downloads.children().length-1;o>=0;o--){var i=this._downloads.children().eq(o),a=i.find(".download-plugin-name").text();if(this.compareCaseInsensitive(t,a)){e&&(e<1&&(e=1),i.find(".download-plugin-bar").css("width",Math.floor(e)+"%"),i.find(".download-plugin-label").html(Math.floor(e)+"%")),n&&i.find(".download-plugin-status").html(n);break}}}},{key:"compareCaseInsensitive",value:function(t,e){return t.toLowerCase()===e.toLowerCase()}},{key:"showlog",value:function(t){this._cliOutput.append($("<div>").html(t))}},{key:"registerDownloadEvent",value:function(){var t=this;c.on("download-status",function(e,n){"interrupted"===n.state?(t.setDownloadItemStatus(n.url,null,"download failed"),t.downloadNext()):"progressing"===n.state&&t.setDownloadItemStatus(n.url,n.downloadRatio,"downloading")}),c.on("download-finish",function(e,n){delete t._dlUrl,"completed"===n.state?(t.setDownloadItemStatus(n.url,100,"downloading"),t.moveDownloadFile(n.url)):(t.setDownloadItemStatus(n.url,null,"download failed"),console.log("download failed:"+n.state)),t.downloadNext()})}},{key:"downloadNext",value:function(){var t=this.findFirstItem("pending");return t?(this.showlog("Begin download "+t.bundle.bundle),void c.send("download-file",t.bundle.bundle)):void this.disableClose()}},{key:"findFirstItem",value:function(t){for(var e in this._installItems){var n=this._installItems[e];if(t==n.status)return n}}},{key:"setDownloadItemStatus",value:function(t,e,n){for(var o in this._installItems){var i=this._installItems[o];if(this.compareCaseInsensitive(t,i.bundle.bundle)||this.compareCaseInsensitive(t,i.name)){n&&(i.status=n),this.changeItemStatus(i.display_name,e,n);break}}}},{key:"moveDownloadFile",value:function(t){var e=this,n=t.split("/").pop(),o=l.join(s.homedir(),".sdkbox","temp",n),i=l.join(s.homedir(),".sdkbox","plugins",n);try{r.rename(o,i,function(){e.setDownloadItemStatus(t,null,"ready"),e.tryInstall()})}catch(e){this.setDownloadItemStatus(t,null,"download failed"),this.tryInstall()}}},{key:"tryInstall",value:function(){var t=this.findFirstItem("pending");t||(t=this.findFirstItem("downloading"),t||this.installNext())}},{key:"installNext",value:function(){var t=this.findFirstItem("ready");return t?(this.showlog("Begin install "+t.name),void this.installPlugin(t.name)):(this._buttonCancel.text("Finish"),this.enableClose(),f.getInstance().getInstalledPlugins(this.options.project,null,!0),void this.showlog("Install Finish"))}},{key:"installPlugin",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"import";if(null==this.options.project)return void this.showlog("Error! Project path is null");if(!this.sdkbox_path)return void this.showlog("Error! Can not find SDKBox installer");var o=d.getInstance(),i="sdkbox import "+this.options.project;if(!o.query(i)){this.setDownloadItemStatus(t,null,"installing");var a=[this.sdkbox_path,"--alwaysupdate","--nohelp","--runin","gui",n,t];t in this.options.installedPlugins&&(a.push("--forcecopy"),a.push("--nopatching"));var s={tag:i,cwd:this.options.project};this.showlog("> "+a.join(" ")),o.exec(a,s,{stdout:function(t){e.showlog(t.toString())},stderr:function(t){e.showlog(t.toString())},exit:function(n,o){e.setDownloadItemStatus(t,null,"success"),e.showlog(""),e.showlog("-----------------------------------"),e.showlog(""),e.installNext()},error:function(n,o,i){e.setDownloadItemStatus(t,null,"install failed"),e.showlog(n.toString()),e.installNext()}})}}}]),t}()},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(6),s=n(7),l=n(2),r=n(24),u=void 0;t.exports=function(){function t(){o(this,t);var e=a.homedir();this._path=l.join(e,".sdkbox","conf","gui.json")}return i(t,null,[{key:"getInstance",value:function(){return u||(u=new t),u}}]),i(t,[{key:"load",value:function(){try{var t=s.readFileSync(this._path),e=JSON.parse(t);return e}catch(t){return console.log(t.toString()),null}}},{key:"save",value:function(t){var e=JSON.stringify(t),n=l.dirname(this._path),o=null;try{o=s.statSync(n)}catch(t){o=null}o&&!o.isDirectory()||r.sync(l.dirname(this._path)),s.writeFileSync(this._path,e)}}]),t}()},function(t,e,n){function o(t,e,n,l){"function"==typeof e?(n=e,e={}):e&&"object"==typeof e||(e={mode:e});var r=e.mode,u=e.fs||a;void 0===r&&(r=s&~process.umask()),l||(l=null);var c=n||function(){};t=i.resolve(t),u.mkdir(t,r,function(n){if(!n)return l=l||t,c(null,l);switch(n.code){case"ENOENT":o(i.dirname(t),e,function(n,i){n?c(n,i):o(t,e,c,i)});break;default:u.stat(t,function(t,e){t||!e.isDirectory()?c(n,l):c(null,l)})}})}var i=n(2),a=n(7),s=parseInt("0777",8);t.exports=o.mkdirp=o.mkdirP=o,o.sync=function t(e,n,o){n&&"object"==typeof n||(n={mode:n});var l=n.mode,r=n.fs||a;void 0===l&&(l=s&~process.umask()),o||(o=null),e=i.resolve(e);try{r.mkdirSync(e,l),o=o||e}catch(a){switch(a.code){case"ENOENT":o=t(i.dirname(e),n,o),t(e,n,o);break;default:var u;try{u=r.statSync(e)}catch(t){throw a}if(!u.isDirectory())throw a}}return o}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={version:"0.0.1",beta:!0};e.Config=n},function(t,e){t.exports=require("url")}]);